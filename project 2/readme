数字水印嵌入与提取及鲁棒性测试实验报告
一、实验背景与目的
数字水印是一种将标记数据隐蔽嵌入声音、图像或视频等载体信号的方法，用于标识版权信息、验证载体的完整性等目的。维基百科对数字水印的定义指出，数字水印是“嵌入在音频、视频或图像等耐噪声信号中的一种标记”，其目的是在不显著改变载体的情况下隐藏信息，用来验证真伪或表明所有者身份。与元数据不同，数字水印并不改变载体数据的大小。本实验旨在基于离散余弦变换实现数字图像水印的嵌入与提取，利用水印对图像泄露进行追踪，并测试水印在常见攻击下的鲁棒性。
二、DCT 水印嵌入与提取方法
2.1 水印嵌入
宿主图像：实验中生成 256×256 的灰度渐变图作为宿主图像
水印图像：生成 64×64 的二值图像，在中央绘制字符 W 作为水印
DCT 嵌入：将宿主图像转换为浮点灰度矩阵，进行二维 DCT
2.2 水印提取
由于嵌入算法基于修改低频 DCT 系数，提取时需要原始宿主图像作为参考。
1.对原始宿主图像和待测图像分别进行二维 DCT
2.用水印强度 α 标准化差值，得到一个实数矩阵
3.为了处理截取等导致尺寸变化的攻击，对待测图像进行中心裁剪或零填充
三、分析与讨论
1.基线情况：本实验使用简单的二值阈值提取，未加噪声时正确率约 42%。由于宿主图像为平滑的灰度渐变，修改低频 DCT 系数后仍有相当一部分系数返回至零附近，导致一些位难以判定。这表明仅根据系数正负判断水印位存在局限。
2.翻转攻击：翻转改变了图像的空间排布。由于嵌入时固定选择左上角的低频系数，在进行水平翻转时提取的低频系数基本保持不变，但位的顺序发生变换，因此整体正确率约 50%，相关性接近 0。垂直翻转有类似现象。
3.平移攻击：平移导致图像 DCT 系数发生相位偏移，低频能量重新分布，提取正确率略有下降。当前算法无法对齐被平移的图像，因此与原水印的相似度降低。
4.截取攻击：中心截取再填充回 256×256 的图像时，低频区域大部分保留，因此提取的水印相似度最高（74%）。这说明低频嵌入方法对局部截取具有较强的鲁棒性。
5.对比度调整：线性调整像素值对 DCT 系数造成的相对变化较小，故正确率与基线接近。实际应用中，对比度和亮度变化属于常见失真，低频嵌入具有较好的抵抗能力。
综合来看，简单的 DCT 低频嵌入算法对亮度/对比度变化和局部截取较为鲁棒，但对几何攻击（翻转、平移）敏感。产生这一现象的根本原因是图像的几何变换会改变 DCT 系数的排列顺序或引入相位偏差，导致提取过程中对位的匹配不正确。
四、结论与改进方向
本实验在不改变功能的前提下重构了水印嵌入与显式水印添加代码，通过模块化和向量化降低了重复度；基于 DCT 实现了简单的二值水印嵌入与提取，并对翻转、平移、截取和对比度调整等攻击进行了鲁棒性测试。实验结果表明，低频 DCT 域嵌入具有一定抗截取和亮度变化能力，但对几何攻击敏感，提取水印的正确率仅略高于随机水平。
